Got it. This `FounderStore` is already quite usable, but there are a few **production-grade fixes** you should make now (especially for SQLite locking, correctness, and avoiding silent confusion).

## Key review notes

### 1) Docstring/API mismatch (will confuse everyone)

Your top-level docstring says:

```py
score = await store.get_founder_score("domain:acme.ai")
```

…but the implementation exposes `get_aggregate_founder_score(...)`, not `get_founder_score`.

**Fix:** update docstring (or add an alias method that calls `get_aggregate_founder_score`).

---

### 2) SQLite locking risk: missing WAL + busy_timeout

Right now `initialize()` only sets `foreign_keys`:

```py
await self._db.execute("PRAGMA foreign_keys = ON")
```

If you run multiple connections (SignalStore + FounderStore) or your sync job runs while pipeline reads, you will eventually hit “database is locked”.

**Fix:** set pragmas immediately after connect:

* `journal_mode=WAL`
* `busy_timeout=5000`
* optional `synchronous=NORMAL`

---

### 3) `ORDER BY ... NULLS LAST` is not reliably SQLite-safe

This query:

```sql
ORDER BY start_date DESC NULLS LAST
```

isn’t guaranteed across SQLite environments. Safer pattern:

```sql
ORDER BY (start_date IS NULL), start_date DESC
```

---

### 4) Write method not using the same transaction lock

`link_founder_to_signal()` writes outside your `transaction()` context and lock:

```py
await self._db.execute(...)
await self._db.commit()
```

Since you use a **single connection** and a transaction lock for `save_founder()`, mixing “locked transactions” and “unlocked commits” can cause intermittent issues under concurrency (or just unpredictable ordering).

**Fix:** wrap writes in `async with self.transaction()` for consistency.

---

### 5) FounderProfile scoring flags can “stick” across recalculations

`_analyze_experiences()` only ever sets flags `True` and never resets them. If a profile object is reused across updates, you can get stale flags influencing the score.

**Fix:** reset derived flags/fields at the start of `_analyze_experiences()`.

---

### 6) Schema design note (not blocking, but important)

You have:

* `founder_key UNIQUE`
* `canonical_key NOT NULL` in `founders`

That hard-codes **one founder → one company**. You’re already compensating by skipping relinks in `founder_sync.py`, which is fine for MVP. Just be aware: true “network intelligence” will eventually want a join table.

---

## Minimal patch suggestions (surgical changes)

### A) Add pragmas in `initialize()`

```py
self._db = await aiosqlite.connect(str(self.db_path))
await self._db.execute("PRAGMA foreign_keys = ON")
await self._db.execute("PRAGMA journal_mode = WAL")
await self._db.execute("PRAGMA busy_timeout = 5000")
await self._db.execute("PRAGMA synchronous = NORMAL")  # optional
```

### B) Fix ordering in `_get_experiences()`

Replace:

```sql
ORDER BY start_date DESC NULLS LAST
```

with:

```sql
ORDER BY (start_date IS NULL), start_date DESC
```

### C) Wrap `link_founder_to_signal()` in a transaction

```py
async with self.transaction() as conn:
    await conn.execute(...)
```

### D) Fix docstring reference

Change the docstring call to:

```py
score = await store.get_aggregate_founder_score("domain:acme.ai")
```

(or add a thin alias method).

### E) Reset flags in `_analyze_experiences()`

At top of method:

```py
self.has_faang_experience = False
self.is_technical = False
self.has_domain_expertise = False
self.has_startup_experience = False
self.is_serial_founder = False
self.years_experience = 0
```

---

## Task list (with “definition of done”)

### P0 — Do now

1. **Add SQLite pragmas (WAL + busy_timeout)**

   * **DoD:** running founder sync + pipeline concurrently does not throw “database is locked” in basic stress testing.

2. **Wrap `link_founder_to_signal()` in your `transaction()`**

   * **DoD:** all write methods use the same lock/transaction pattern.

3. **Replace `NULLS LAST` ordering**

   * **DoD:** `_get_experiences()` works on SQLite consistently (tests pass).

4. **Fix docstring/API mismatch**

   * **DoD:** docs only reference real methods (or alias exists).

### P1 — Next (correctness hardening)

5. **Reset derived scoring flags before analyzing experiences**

   * **DoD:** recalculating score after modifying experiences produces correct, stable results.

### P2 — Later (if network features expand)

6. **Plan join-table refactor for founder↔company**

   * **DoD:** same founder can be linked to multiple canonical keys without overwrite, enabling clean network views.

---

If you want, I can rewrite your `initialize()` and `link_founder_to_signal()` blocks exactly as a ready-to-paste diff (minimal changes only).
